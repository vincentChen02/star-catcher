{"version":3,"sources":["..\\..\\..\\..\\assets\\scripts/assets\\scripts\\Game.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\assets\\scripts","sourcesContent":["\r\n// import { Player } from \"./Player\";\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class Game extends cc.Component {\r\n\r\n    // 这个属性引用了星星的预制资源\r\n    @property(cc.Prefab)\r\n    private starPrefab: cc.Prefab = null;\r\n\r\n    //星星显示持续时间\r\n    @property(cc.Integer)\r\n    private maxStarDuration: number = 0;\r\n    @property(cc.Integer)\r\n    private minStarDuration: number = 0;\r\n\r\n    //地面节点，用于确定星星的高度\r\n    @property(cc.Node)\r\n    public groundNode: cc.Node = null;\r\n    // player 节点，用于获取主角弹跳的高度，和控制主角行动开关\r\n    @property(cc.Node)\r\n    public playerNode: cc.Node = null;\r\n\r\n    @property(cc.Label)\r\n    private scoreLabel: cc.Label = null;\r\n    // 得分音效资源\r\n    @property(cc.AudioClip)\r\n    private scoreAudio: cc.AudioClip = null;\r\n\r\n    //地平面Y坐标\r\n    private groundY: number;\r\n    // 定时器\r\n    public timer: number;\r\n    // 星星存在的持续时间\r\n    public starDuration: number;\r\n    // 当前分数\r\n    private score: number;\r\n\r\n    //初始化\r\n    protected onLoad() {\r\n        this.groundY = this.groundNode.y + this.groundNode.height / 2;\r\n        this.timer = 0;\r\n        this.score = 0;\r\n        this.starDuration = 0;\r\n        this.scoreLabel.string = 'Score: ' + this.score.toString();\r\n\r\n        this.spawnNewStar();\r\n    }\r\n\r\n    // 生成一个新的星星\r\n    private spawnNewStar() {\r\n        let newStar = cc.instantiate(this.starPrefab);\r\n        this.node.addChild(newStar);\r\n        newStar.setPosition(this.starSpawnPosition());\r\n        newStar.getComponent('Star').init(this);\r\n        // 重置计时器\r\n        this.starDuration = this.minStarDuration + cc.random0To1() * (this.maxStarDuration - this.minStarDuration);\r\n        this.timer = 0;\r\n    }\r\n    //星星生成位置\r\n    private starSpawnPosition() {\r\n        //星星坐标\r\n        let randY = 0, randX = 0;\r\n        randY = this.groundY + cc.random0To1() * this.playerNode.getComponent('Player').jumpHeight + 50;//50是星星与主角最大的收集距离\r\n        let maxX = this.node.width / 2;//根据屏幕宽度生成\r\n        randX = cc.randomMinus1To1() * maxX;\r\n        return cc.p(randX, randY);\r\n    }\r\n    //在星星最大时限内没有吃到星星，游戏失败\r\n    protected update(dt) {\r\n        if (this.timer > this.starDuration) {\r\n            return this.gameOver();\r\n        }\r\n        this.timer += dt;\r\n    }\r\n    //得分\r\n    public getScore() {\r\n        this.score += 1;\r\n        this.scoreLabel.string = 'Score: ' + this.score.toString();\r\n        // 播放音效 不加as any就会报错\r\n        cc.audioEngine.play(this.scoreAudio as any, false, 1);\r\n    }\r\n    //游戏失败\r\n    private gameOver() {\r\n        this.playerNode.stopAllActions();\r\n        cc.director.loadScene('game');\r\n    }\r\n}\r\n"]}